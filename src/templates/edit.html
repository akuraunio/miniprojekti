{% extends "layout.html" %}

{% block title %}Muokkaa viitettä {{ reference.fields[ReferenceField.KEY] }} - Viitteet{% endblock %}

{% block content %}
<h2>Muokkaa viitettä {{ reference.fields[ReferenceField.KEY] }}</h2>

<form class="reference-form" method="POST" action="{{ url_for('edit', reference_id=reference.id) }}">
  <wa-select multiple label="Tagi" appearance="filled" name="tag">
    {% for tag, tag_name in tag_names.items() %}
    <wa-option {% if reference.current_tags and reference.current_tags|selectattr("name", "equalto", tag)|list %}selected{% endif %} value="{{ tag }}">{{ tag_name }}</wa-option>
    {% endfor %}
  </wa-select>

  <wa-divider></wa-divider>

  {% for field, data in reference_data[reference.type]["fields"].items() %} {% if data["required"]
  %} {% include "reference_form_field.html" with context %} {% endif %} {% endfor %}
  <wa-details open appearance="plain" icon-placement="start" class="reference-form-optional-fields">
    <div class="reference-form-optional-fields-summary" slot="summary">
      <p>Valinnaiset kentät</p>
    </div>
    {% for field, data in reference_data[reference.type]["fields"].items() %} {% if not
    data["required"] %} {% include "reference_form_field.html" with context %} {% endif %} {% endfor
    %}
  </wa-details>

  <input type="hidden" name="reference_type" value="{{ reference.type.value }}" />

  <div class="reference-form-actions">
    <wa-button variant="brand" type="submit" value="tallenna">Tallenna</wa-button>
    <wa-button variant="brand" appearance="plain" onclick="window.history.back()"
      >Takaisin</wa-button
    >
  </div>
</form>
{% endblock %}
