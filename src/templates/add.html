{% extends "layout.html" %} {% block title %}Lisää {{ reference_data[reference_type]["name"] }} -
Viitteet{% endblock %} {% block content %}
<form method="GET" action="{{ url_for('add') }}">
  <label>DOI</label>
  <input type="text" name="doi">
  <input type="hidden" name="type" value="{{ reference_type.value }}">
  <button type="submit">Hae DOI</button>
</form>
<br>

<form method="POST" action="{{ url_for('add') }}">
<<<<<<< HEAD
  {% for field, data in reference_data[reference_type]["fields"].items() %} {% if field !=
  ReferenceField.TAG and data["required"] %} {% if reference_fields[field]["type"] ==
  ReferenceFieldType.TEXT %}

  <label>{{ reference_fields[field]["name"] }}*</label><br />
  <input
    type="text"
    name="{{ field.value }}"
    required
=======
  {% for field, data in reference_data[reference_type]["fields"].items() %}
  
  {% set value = prefill_data.get(field.value, "") %}

  
  {% if reference_fields[field]["type"] == ReferenceFieldType.TEXT %}

  <label>{{ reference_fields[field]["name"] }}{% if data["required"] %}*{% endif %}</label><br />
  <input type="text" name="{{ field.value }}" 
    value="{{ value }}"
    {% if data["required"] %}required{% endif %}
>>>>>>> 217cbb4 (DOI täyttää osan viitteen kenistä ja editor muutettu e ivälttämättömäksi kentäksi (DOI datasta ei löydy monesta viitteestä editoria))
    pattern=".*[0-9A-Za-zÄÖÅäöå].*"
    title="Syötä ainakin yksi kirjain tai numero" /><br />

  {% elif reference_fields[field]["type"] == ReferenceFieldType.TEXTAREA %}

<<<<<<< HEAD
  <label>{{ reference_fields[field]["name"] }}*</label><br />
  <textarea name="{{ field.value }}" required></textarea><br />

  {% elif reference_fields[field]["type"] == ReferenceFieldType.NUMBER %}

  <label>{{ reference_fields[field]["name"] }}*</label><br />
  <input type="number" name="{{ field.value }}" required min="0" /><br />
=======
  <label>{{ reference_fields[field]["name"] }}{% if data["required"] %}*{% endif %}</label><br />
  <textarea name="{{ field.value }}"{% if data["required"] %}required{% endif %}>{{ value }}</textarea><br />

  {% elif reference_fields[field]["type"] == ReferenceFieldType.NUMBER %}

  <label>{{ reference_fields[field]["name"] }}{% if data["required"] %}*{% endif %}</label><br />
  <input type="number" name="{{ field.value }}" value="{{ value }}" {% if data["required"] %}required{% endif %} min="0"/><br />
>>>>>>> 217cbb4 (DOI täyttää osan viitteen kenistä ja editor muutettu e ivälttämättömäksi kentäksi (DOI datasta ei löydy monesta viitteestä editoria))

  {% endif %} {% endif %} {% endfor %}

  <label>Tagi*</label><br />
  <select name="tag" required>
    <option value="">Valitse tagi</option>
    <option value="kandityö">Kandidaatintutkielma</option>
    <option value="gradu">Pro gradu -tutkielma</option>
    <option value="väitöskirja">Väitöskirja</option></select
  ><br />

  {% for field, data in reference_data[reference_type]["fields"].items() %} {% if field !=
  ReferenceField.TAG and not data["required"] %} {% if reference_fields[field]["type"] ==
  ReferenceFieldType.TEXT %}

  <label>{{ reference_fields[field]["name"] }}</label><br />
  <input
    type="text"
    name="{{ field.value }}"
    pattern=".*[0-9A-Za-zÄÖÅäöå].*"
    title="Syötä ainakin yksi kirjain tai numero" /><br />

  {% elif reference_fields[field]["type"] == ReferenceFieldType.TEXTAREA %}

  <label>{{ reference_fields[field]["name"] }}</label><br />
  <textarea name="{{ field.value }}"></textarea><br />

  {% elif reference_fields[field]["type"] == ReferenceFieldType.NUMBER %}

  <label>{{ reference_fields[field]["name"] }}</label><br />
  <input type="number" name="{{ field.value }}" min="0" /><br />

  {% endif %} {% endif %} {% endfor %}

  <input type="hidden" name="reference_type" value="{{ reference_type.value }}" />
  <br />
  <button type="submit">Lisää</button>
</form>

<br /><a href="{{ url_for('index') }}">Takaisin</a>
{% endblock %}
